# Vim操作技巧
## vim批量替换

```bash
# 在命令模式下

# 将文档中所有abc替换为tttt
:%s/abc/tttt/g

# 如果有转义字符，需要在字符前使用 \
# 将 /path/to/myfile 替换为 /otherpath/to/otherfile
:%s/\/path\/to\/myfile/\/otherpath\/to\/otherfile/g
```

## 注意事项

* 插入模式到`<esc>`算一个修改单元
* 插入模式中使用上下左右方向键，相当于之前的操作为一个修改单元，后续的操作为另一个修改单元
* 操作符+动作命令=操作
<!-- more -->
## 常用命令

模式切换
按键操作|含义
------|-----
`<ESC>`|切换到普通模式
`<ctrl-[>`|通esc切换到普通模式
`<ctrl-o>`|切换到插入-普通模式（运行一个普通模式命令后回来原来位置继续输入）
r{char}|替换一个字符后马上切换回普通模式
gr{char}|同上
R|普通模式切换到替换模式（该模式tab制表符会被当成一个字符，输入一个字符会直接替换掉）
gR|普通模式切换到虚拟替换模式（该模式tab制表符会被当成4个字符，按屏幕上实际显示宽度来替换字符）
`insert`|插入模式切-替换模式互相切换
v|面向字符的可视模式
V|面向行的可视模式
ctrl-v|面向列块的可视模式
gv|重选上次的高亮选区

删除内容并切换成输入模式：c+普通模式中的光标移动可以组合成一个修改单元

字符|含义
---|---
i|当前光标所在字符前
I|^i当前行最前面
a|当前光标所在字符后
A|$a当前行最后面
C|c$删除光标当前位置到行尾的内容
s|cl删除光标所在字符
S|^C删除光标所在行的全部内容
o|A光标所在行上面新插入一行
O|ko光标所在行下面新插入一行
cw|删除从光标位置到单词结尾间的字符



## vim操作符命令

* 操作符连续2次调用，表示作用于当前行（dd:删除当前行，gUgU/gUU：当前行全部大写）

命令|用途
---|---
c|修改
d|删除
y|复制到寄存器(p粘贴)
p|粘贴
g~|反转大小写
gu|转换成小写
gU|转换成大写
`>`|增加缩进
`<`|减小缩进
=|自动缩进
`!`|使用外部程序过滤{motion}所跨越的行

* 动作命令

次数执行命令：`d2w`（删除2个单词），`2dw`（执行2次删除单词操作）

字符|含义
---|---
x|删除光标下字符
u|撤销上次修改
zz|重绘屏幕，向上滚动半屏
yyp|复制光标所在行并插入下一行中
dd|删除光标所在行
`>G`|增加从当前行到文档末尾处的缩进层级
t,|光标位置到，前
it|标签里的内容
gg|跳转到文件开头
G|跳转到文件最后一行行首
b|移动光标到上一个单词开头
w|移动光标到下一个单词开头
aw|光标所在单词
e|移动到下一个单词结尾
h|光标向左移动
j|光标向下移动
k|光标向上移动
l|光标向右移动
^|移动光标到行首
$|移动光标到行尾
20ctrl+a|数字+20
`[count]`ctrl+x|数字-count（光标不在数字上，命名会把当前光标之上或者之后的数字-count）

* 可重复的操作及回退

目的|操作|重复|回退
---|----|----|----
做出一个修改|{edit}|.|u
在行内查找下一指定字符|f{char}/t{char}|;|,
在行内查找上一指定字符|F{char}/T{char}|;|,
在文档中查找下一处匹配项|/pattern|n|N
在文档中插上上一处匹配项|?pattern|n|N
在文档中查找下一个匹配项（高亮所有光标所在单词）|`*`|n|N
执行替换(%:全局)(1,2：替换1-2行)|:[addr]s/target/replacement|&|u
执行一系列修改(宏)|qx{changes}q|@x|u

* 输入模式

字符|含义
---|---
`<ctrl-h>`|删除前一个字符
`<ctrl-w>`|删除前一个单词
`<ctrl-u>`|删除至行首
`<ctrl-r>0`|粘贴寄存器0的内容
`<ctrl-r>=6*23<enter>`|寄存器当计算器使用，会将结果插入光标位置
`<ctrl-p>`|选择XXX内容
`<ctrl-v>{code}`|code包含3位数字插入字符例如插入A:`<ctrl-v>065`
`<ctrl-v>u{code}`|u表示使用16进制的unicode编码
`<ctrl-k>{char1}{char2}`|插入以二合字母{char1}{char2}表示的字符1/2：`<ctrl-k>12`